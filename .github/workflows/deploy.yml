name: Auto Deploy

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    if: success()
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.12'
      
      - name: Install dependencies
        run: pip install -r requirements.txt
      
      - name: Run tests before deploy
        run: python -m pytest tests/ -v
      
      - name: Deploy simulation
        run: |
          echo "ðŸš€ DÃ©ploiement en cours..."
          echo "Application: Flask"
          echo "Branch: ${{ github.ref }}"
          echo "Commit: ${{ github.sha }}"
          echo "âœ… DÃ©ploiement rÃ©ussi !"
      
      - name: Webhook deploy (simulation)
        run: |
          echo "Si j'avais une URL de dÃ©ploiement :"
          echo "curl -X POST ${{ secrets.DEPLOY_HOOK }}"